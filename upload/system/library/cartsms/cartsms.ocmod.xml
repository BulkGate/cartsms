<?xml version="1.0" encoding="utf-8"?>
<modification>
    <name>CartSMS - SMS module for OpenCart</name>
    <version>6.00</version>
    <author>BulkGate</author>
    <link>http://www.cartsms.com/</link>
    <file path="admin/controller/common/column_left.php">
        <operation>
            <search><![CDATA[
                $customer = array();
            ]]>
            </search>
            <add position="before"><![CDATA[
            if($this->user->hasPermission('access', 'cartsms/sign'))
            {
                // CartSMS
                $cartsms = new CartSms\Init($this->registry);
                $data['menus'][] = $cartsms->menu();
            }
            ]]>
            </add>
        </operation>
    </file>
    <file path="admin/view/template/sale/order_info.twig">
        <operation>
            <search><![CDATA[
                <input type="checkbox" name="notify" value="1" id="input-notify" />
		    ]]>
            </search>
            <add position="after"><![CDATA[
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label" for="input-notify">SMS</label>
                  <div class="col-sm-10">
                    <div class="checkbox">
                      <input type="checkbox" name="notifySms" value="1" id="input-notify" checked="checked"/>
            ]]>
            </add>
        </operation>
        <operation>
            <search><![CDATA[data: 'order_status_id=' + encodeURIComponent($('select[name=\'order_status_id\']').val()) + '&notify=' + ($('input[name=\'notify\']').prop('checked') ? 1 : 0) + '&override=' + ($('input[name=\'override\']').prop('checked') ? 1 : 0) + '&append=' + ($('input[name=\'append\']').prop('checked') ? 1 : 0) + '&comment=' + encodeURIComponent($('textarea[name=\'comment\']').val()),]]></search>
            <add position="replace"><![CDATA[data: 'order_status_id=' + encodeURIComponent($('select[name=\'order_status_id\']').val()) + '&notify=' + ($('input[name=\'notify\']').prop('checked') ? 1 : 0) + '&notifySms=' + ($('input[name=\'notifySms\']').prop('checked') ? 1 : 0) + '&override=' + ($('input[name=\'override\']').prop('checked') ? 1 : 0) + '&append=' + ($('input[name=\'append\']').prop('checked') ? 1 : 0) + '&comment=' + encodeURIComponent($('textarea[name=\'comment\']').val()),]]></add>
        </operation>
    </file>
    <file path="catalog/controller/information/contact.php">
        <operation>
            <search><![CDATA[
                $mail->send();
            ]]>
            </search>
            <add  position="after"><![CDATA[
                $this->event->trigger('bulkgate/cartsms/contact/form/hook', array(
                    'bulkgate/cartsms/contact/form/hook',
                    array(
                        $this->request->post['email'],
                        $this->request->post['name'],
                        $this->request->post['enquiry']
                    )
                ));
            ]]>
            </add>
        </operation>
    </file>
    <file path="catalog/controller/checkout/success.php" error="skip">
        <operation>
            <search><![CDATA[
                $this->cart->clear();
            ]]>
            </search>
            <add position="before"><![CDATA[
                $this->event->trigger('bulkgate/cartsms/new/order/hook', array(
                    'bulkgate/cartsms/new/order/hook',
                    array(
                        $this->session->data['order_id']
                    )
                ));
            ]]>
            </add>
        </operation>
    </file>
</modification>
